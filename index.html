<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GenZstore</title>

<style>
    /* ======================= SKELETON LOADER STYLES START HERE ======================= */
    @keyframes shimmer-animation {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    .skeleton-card {
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--border-color);
        border-radius: 20px 20px 5px 5px;
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }
    .skeleton-image {
        width: 100%;
        height: 280px; /* Adjust height to match your product images */
        background-color: #e0e0e0;
        position: relative;
        overflow: hidden;
    }
    .skeleton-info { padding: 1.5rem; }
    .skeleton-text {
        height: 1.2rem;
        margin-bottom: 1rem;
        border-radius: 4px;
        background-color: #e0e0e0;
        position: relative;
        overflow: hidden;
    }
    .skeleton-title { height: 1.8rem; width: 80%; }
    .skeleton-price { width: 40%; height: 1.5rem; }
    .skeleton-button {
        height: 3rem;
        border-radius: 10px;
        margin-top: 1.5rem;
        background-color: #e0e0e0;
        position: relative;
        overflow: hidden;
    }
    .skeleton-image::before,
    .skeleton-text::before,
    .skeleton-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
        animation: shimmer-animation 1.5s infinite linear;
    }
    /* ======================= SKELETON LOADER STYLES END HERE ======================= */

    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
    :root {
        --bg-gradient: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);
        --card-bg: rgba(255, 255, 255, 0.35);
        --text-dark: #2c3e50;
        --text-light: #576574;
        --accent-color: #3498db;
        --accent-hover: #2980b9;
        --border-color: rgba(255, 255, 255, 0.5);
        --neon-cyan: #00e5ff;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { font-family: 'Poppins', sans-serif; background-image: var(--bg-gradient); color: var(--text-dark); line-height: 1.7; overflow-x: hidden; min-height: 100vh; position: relative; }
    body.modal-open, body.nav-open { overflow: hidden; }
    body::before, body::after { content: ''; position: absolute; z-index: -1; border-radius: 50%; filter: blur(100px); }
    body::before { width: 300px; height: 300px; background-color: rgba(52, 152, 219, 0.2); top: 5%; left: 10%; }
    body::after { width: 250px; height: 250px; background-color: rgba(0, 229, 255, 0.15); bottom: 10%; right: 15%; }
    .container { width: 90%; max-width: 1200px; margin: 2rem auto; padding: 0 15px; }
    
    header.container { display: flex; justify-content: center; align-items: center; position: relative; }
    .store-logo { height: 120px; display: block; margin: 0 auto; }
    .menu-button { width: 40px; height: 30px; position: absolute; right: 15px; top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; justify-content: space-between; cursor: pointer; z-index: 1101; }
    .menu-button span { width: 100%; height: 4px; background-color: var(--text-dark); border-radius: 2px; transition: all 0.3s ease; }
    .menu-button.active span:nth-child(1) { transform: translateY(13px) rotate(45deg); }
    .menu-button.active span:nth-child(2) { opacity: 0; }
    .menu-button.active span:nth-child(3) { transform: translateY(-13px) rotate(-45deg); }
    .main-nav { position: fixed; top: 0; right: -100%; width: 280px; height: 100%; background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); z-index: 1100; transition: right 0.4s ease-in-out; display: flex; align-items: center; justify-content: center; box-shadow: -5px 0 25px rgba(0,0,0,0.1); }
    .main-nav.open { right: 0; }
    .main-nav ul { list-style: none; padding: 0; }
    .main-nav ul li { margin: 2.5rem 0; text-align: center; }
    .main-nav ul li a { color: var(--text-dark); text-decoration: none; font-size: 1.5rem; font-weight: 600; transition: color 0.3s ease; }
    .main-nav ul li a:hover { color: var(--accent-color); }
    #nav-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.4); z-index: 1099; opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0.4s ease; }
    #nav-backdrop.visible { opacity: 1; visibility: visible; }
    
    h1 { font-size: 3rem; font-weight: 700; text-align: center; margin-bottom: 1rem; }
    h2 { font-size: 2.2rem; font-weight: 400; color: var(--text-light); text-align: center; margin-bottom: 1.5rem; }
    .gender-filter-buttons { display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap; }
    .gender-btn { padding: 0.6rem 1.8rem; font-size: 1rem; font-weight: 600; border: 2px solid var(--accent-color); background: transparent; color: var(--accent-color); border-radius: 10px; cursor: pointer; transition: all 0.3s ease; }
    .gender-btn:hover { background-color: var(--accent-hover); color: #fff; transform: translateY(-3px); box-shadow: 0 6px 20px rgba(41, 128, 185, 0.3); }
    .gender-btn.active { background-color: var(--accent-color); color: #fff; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4); }
    .select-container { display: flex; justify-content: center; margin-bottom: 3rem; }
    .select-container label { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0; }
    #subcategory-select { -webkit-appearance: none; -moz-appearance: none; appearance: none; padding: 0.9rem 3.5rem 0.9rem 2rem; font-size: 1.1rem; font-family: 'Poppins', sans-serif; font-weight: 600; color: var(--text-dark); background-color: rgba(255, 255, 255, 0.35); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.5); border-radius: 50px; cursor: pointer; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%232c3e50%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'); background-repeat: no-repeat; background-position: right 1.5rem center; background-size: .7em auto; transition: all 0.3s ease; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); }
    #subcategory-select:hover { border-color: var(--accent-color); box-shadow: 0 6px 25px rgba(52, 152, 219, 0.2); }
    #subcategory-select:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.3); }
    #product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2.5rem; align-items: start; }
    .product-card { background: var(--card-bg); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--border-color); border-radius: 20px 20px 5px 5px; box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1); display: flex; flex-direction: column; transition: transform 0.3s ease, box-shadow 0.3s ease; position: relative; overflow: hidden; will-change: transform; }
    .product-card:hover { transform: translateY(-12px); box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.15); }
    .product-card--focused { overflow: visible; z-index: 10; }
    .product-image { width: 100%; height: auto; object-fit: contain; }
    .product-info { padding: 1.5rem; flex-grow: 1; display: flex; flex-direction: column; }
    .product-name { font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
    .product-price { font-size: 1.3rem; font-weight: 700; color: var(--accent-color); margin-bottom: 0.5rem; }
    .product-description { font-size: 0.85rem; color: var(--text-light); margin-bottom: 1rem; font-weight: 300; }
    .custom-select-wrapper { position: relative; margin-bottom: 1.5rem; }
    .select-selected {
    background-color: rgba(255, 255, 255, 0.2); /* ‡§∏‡•á‡§Æ‡•Ä-‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§™‡•á‡§∞‡•á‡§Ç‡§ü ‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° */
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    padding: 0.6rem 1rem;
    border-radius: 8px;
    border: 1px solid var(--border-color); /* ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•á ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ú‡•à‡§∏‡§æ ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ */
    color: var(--text-dark); /* ‡§ó‡§π‡§∞‡§æ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§§‡§æ‡§ï‡§ø ‡§™‡§¢‡§º‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ü‡§è */
    cursor: pointer;
    transition: border-color 0.3s ease;
    position: relative;
    user-select: none;
}

    .select-selected:hover { border-color: var(--accent-color); }
    .select-selected::after {
    content: "";
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    width: 0;
    height: 0;
    border: 6px solid transparent;
    border-color: var(--text-dark) transparent transparent transparent;
    /* ‡§§‡•Ä‡§∞ ‡§ï‡§æ ‡§∞‡§Ç‡§ó ‡§¨‡§¶‡§≤ ‡§¶‡§ø‡§Ø‡§æ */
}
    .select-items { position: absolute; background-color: rgba(18, 24, 45, 0.9); backdrop-filter: blur(10px); top: calc(100% + 5px); left: 0; right: 0; z-index: 99; border-radius: 12px; border: 1px solid var(--neon-cyan); box-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan); overflow: hidden; display: none; }
    .select-items div { color: #fff; padding: 10px 16px; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease; }
    .select-items div:hover { background-color: var(--neon-cyan); color: #000; }
    .custom-select-wrapper select { display: none; }
    .buy-now-btn { background-color: var(--accent-color); color: #fff; border: none; padding: 0.9rem 1rem; border-radius: 10px; cursor: pointer; text-transform: uppercase; font-weight: 600; transition: background-color 0.3s ease, transform 0.2s ease; margin-top: auto; }
    .buy-now-btn:hover { background-color: var(--accent-hover); transform: scale(1.03); }
    .buy-now-btn:active { transform: scale(0.98); }
    footer { text-align: center; padding: 2.5rem 0; margin-top: 4rem; border-top: 1px solid #e0e0e0; }
    footer p { font-size: 1rem; font-weight: 300; color: var(--text-light); margin-bottom: 1rem; }
    .modal-overlay { position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(8px); z-index: 1000; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease; }
    .modal-overlay.active { display: flex; opacity: 1; }
    .modal-container { background: rgba(30, 30, 50, 0.5); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); border: 1px solid rgba(0, 229, 255, 0.5); border-radius: 20px; padding: 2.5rem; width: 90%; max-width: 500px; color: #fff; position: relative; box-shadow: 0 0 15px rgba(0, 229, 255, 0.3), 0 0 30px rgba(0, 229, 255, 0.2); transform: scale(0.9); transition: transform 0.3s ease; max-height: 85vh; overflow-y: auto; }
    .modal-overlay.active .modal-container { transform: scale(1); }
    .close-btn { position: absolute; top: 15px; right: 20px; font-size: 2rem; color: #fff; cursor: pointer; transition: transform 0.2s ease; user-select: none; }
    .close-btn:hover { transform: scale(1.2); }
    .modal-form h3 { text-align: center; margin-bottom: 1rem; font-weight: 600; color: var(--neon-cyan); text-shadow: 0 0 5px var(--neon-cyan); }
    .form-product-details { text-align: center; margin-bottom: 2rem; border-bottom: 1px solid rgba(0, 229, 255, 0.3); padding-bottom: 1rem; }
    .form-product-details p { margin: 0.2rem 0; }
    #form-product-name { font-weight: 600; font-size: 1.1rem; }
    .form-group { margin-bottom: 1.5rem; }
    .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 300; }
    .form-group input, .form-group select { width: 100%; padding: 0.8rem; background: transparent; border: 1px solid var(--neon-cyan); border-radius: 8px; color: #fff; font-size: 1rem; transition: box-shadow 0.3s ease; }
    .form-group select { color: #000; background-color: #fff; } /* Style for the select dropdown */
    .form-group input:focus, .form-group select:focus { outline: none; box-shadow: 0 0 10px var(--neon-cyan); }
    .form-group input::placeholder { color: rgba(255, 255, 255, 0.5); }
    .modal-btn { width: 100%; padding: 0.9rem; border: none; border-radius: 8px; background-color: var(--neon-cyan); color: #000; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: all 0.3s ease; }
    .modal-btn:hover { background-color: #fff; box-shadow: 0 0 15px var(--neon-cyan); }
    
    #admin-panel-modal-container { max-width: 700px; }
    #admin-links-table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; }
    #admin-links-table th, #admin-links-table td { padding: 12px; text-align: left; border-bottom: 1px solid rgba(0, 229, 255, 0.3); vertical-align: middle; }
    #admin-links-table th { color: var(--neon-cyan); }
    #admin-links-table td { display: flex; align-items: center; }
    #admin-links-table a { display: inline-block; margin-left: auto; padding: 8px 18px; border: 1px solid var(--neon-cyan); border-radius: 8px; color: var(--neon-cyan); background-color: transparent; text-decoration: none; font-weight: 600; transition: all 0.3s ease; cursor: pointer; }
    #admin-links-table a:hover { background-color: var(--neon-cyan); color: #000; box-shadow: 0 0 15px var(--neon-cyan); transform: translateY(-2px); }
    .admin-panel-product-img { width: 45px; height: 55px; object-fit: cover; border-radius: 8px; margin-right: 15px; flex-shrink: 0; }
    
    @media (max-width: 768px) { 
        h1 { font-size: 2.5rem; } 
        h2 { font-size: 1.8rem; } 
        .store-logo { height: 100px; }
    }
    @keyframes animate-gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
    .product-card--exclusive::before { content: ''; position: absolute; inset: 0; z-index: 0; background: linear-gradient(125deg, #ffc371, #ff5f6d, #833ab4, #00d4ff); background-size: 400% 400%; animation: animate-gradient 10s ease infinite; opacity: 0.15; transition: opacity 0.3s ease; }
    .product-card--exclusive:hover::before { opacity: 0.25; }
    .product-card .product-image, .product-card .product-info { position: relative; z-index: 1; }
    .product-card--exclusive::after { content: 'EXCLUSIVE'; position: absolute; top: 10px; right: -35px; z-index: 2; background-color: #ffae00; color: #000; font-size: 0.7rem; font-weight: 700; padding: 5px 30px; transform: rotate(45deg); box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
</style>
</head>
<body>

<div id="nav-backdrop"></div>
<nav id="main-nav" class="main-nav">
    <ul>
        <li><a href="#" id="nav-admin-link">Admin Access</a></li>
        <li><a href="https://www.instagram.com/undermaintnance?igsh=bmx3NDV2eGlsYjY2" target="_blank">Instagram</a></li>
        <li><a href="#" id="nav-whatsapp-link" target="_blank">Contact on WhatsApp</a></li>
    </ul>
</nav>

<div id="main-content">
    <header class="container">
        <img src="https://i.ibb.co/8ncQVyqT/Blue-and-Gold-Elegant-Graduation-Ceremony-Banner-Landscape-20250826-161144-0000.png" alt="GenZstore Logo" class="store-logo">
        <div id="menu-button" class="menu-button">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </header>
    <main class="container">
        <section id="products">
            <h2>Discover Your Style</h2>
            <div class="search-container" style="display: flex; justify-content: center; margin-bottom: 2rem;">
    <input type="search" id="search-input" placeholder="Search for products..." style="padding: 0.9rem 1.5rem; font-size: 1.1rem; width: 80%; max-width: 500px; border-radius: 50px; border: 1px solid var(--border-color); background-color: rgba(255, 255, 255, 0.35);">
</div>

            <div class="gender-filter-buttons">
                <button class="gender-btn active" data-gender="boy">For Boys</button>
                <button class="gender-btn" data-gender="girl">For Girls</button>
                <button class="gender-btn" data-gender="other">Others</button>
                <button class="gender-btn" data-gender="exclusive">Exclusive</button>
            </div>
            <div class="select-container" id="subcategory-container">
                <label for="subcategory-select">Select a Category:</label>
                <select id="subcategory-select"></select>
            </div>
            <div id="product-grid">
                <div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-info"><div class="skeleton-text skeleton-title"></div><div class="skeleton-text skeleton-price"></div><div class="skeleton-text"></div><div class="skeleton-text"></div><div class="skeleton-button"></div></div></div>
                <div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-info"><div class="skeleton-text skeleton-title"></div><div class="skeleton-text skeleton-price"></div><div class="skeleton-text"></div><div class="skeleton-text"></div><div class="skeleton-button"></div></div></div>
                <div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-info"><div class="skeleton-text skeleton-title"></div><div class="skeleton-text skeleton-price"></div><div class="skeleton-text"></div><div class="skeleton-text"></div><div class="skeleton-button"></div></div></div>
                <div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-info"><div class="skeleton-text skeleton-title"></div><div class="skeleton-text skeleton-price"></div><div class="skeleton-text"></div><div class="skeleton-text"></div><div class="skeleton-button"></div></div></div>
            </div>
        </section>
    </main>
    <footer>
        <span>Our products will be uploaded soon...</span>
        <p>Created by AKASH DUBEY</p>
    </footer>
</div>

<div id="order-modal-overlay" class="modal-overlay">
    <div id="order-form-container" class="modal-container">
        <span class="close-btn">&times;</span>
        <form id="order-form" class="modal-form">
            <h3>Confirm Your Order</h3>
            <div class="form-product-details">
                <p id="form-product-name-display"></p>
                <p>Price: ‚Çπ<span id="form-product-price-display"></span> per item | Size: <span id="form-product-size-display"></span></p>
            </div>
            <div class="form-group"><label for="customer-name">Your Name</label><input type="text" id="customer-name" placeholder="Enter your full name" required></div>
            <div class="form-group"><label for="customer-phone">Your WhatsApp Number</label><input type="tel" id="customer-phone" placeholder="Enter your phone number" required></div>
            <div class="form-group"><label for="customer-address">Address</label><input type="text" id="customer-address" placeholder="Enter your address" required></div>
            <div class="form-group">
                <label for="customer-quantity">Quantity</label>
                <select id="customer-quantity" required></select>
            </div>
            <button type="submit" class="modal-btn">Order Now</button>
        </form>
    </div>
</div>

<div id="admin-login-modal-overlay" class="modal-overlay">
    <div class="modal-container">
        <span class="close-btn">&times;</span>
        <form id="admin-login-form" class="modal-form">
            <h3>Admin Access</h3>
            <div class="form-group"><label for="admin-password">Password</label><input type="password" id="admin-password" required></div>
            <button type="submit" class="modal-btn">Login</button>
        </form>
    </div>
</div>

<div id="admin-panel-modal-overlay" class="modal-overlay">
    <div id="admin-panel-modal-container" class="modal-container">
        <span class="close-btn">&times;</span>
        <h3>Product Source Links</h3>
        <table id="admin-links-table">
            <thead><tr><th>Product</th><th>Source Link</th></tr></thead>
            <tbody id="admin-links-tbody"></tbody>
        </table>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- CONFIGURATION ---
    const ADMIN_PASSWORD = 'AKASH7777';
    const ADMIN_PHONE_NUMBER = '7822976749';
    
    // --- GLOBAL STATE ---
    let allProductsCombined = []; // Ab products yahan store honge
    let currentGender = 'boy';
    let currentSubcategory = 'all';
    
    // --- DOM ELEMENTS ---
    const productGrid = document.getElementById('product-grid');
    const genderFilterContainer = document.querySelector('.gender-filter-buttons');
    const subcategorySelect = document.getElementById('subcategory-select');
    const adminLoginModal = document.getElementById('admin-login-modal-overlay');
    const adminPanelModal = document.getElementById('admin-panel-modal-overlay');
    const orderModal = document.getElementById('order-modal-overlay');
    const menuButton = document.getElementById('menu-button');
    const mainNav = document.getElementById('main-nav');
    const navBackdrop = document.getElementById('nav-backdrop');
    const navAdminLink = document.getElementById('nav-admin-link');
    const navWhatsappLink = document.getElementById('nav-whatsapp-link');
    
    // --- PRODUCT DATA FETCHING ---
    async function fetchProducts() {
        try {
            const response = await fetch('products.json');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            allProductsCombined = await response.json();
            populateSubcategoryDropdown();
            renderProducts();
        } catch (error) {
            console.error("Failed to fetch products:", error);
            productGrid.innerHTML = `<p style="text-align:center; grid-column: 1/-1;">Sorry, products could not be loaded.</p>`;
        }
    }
    
    // --- HELPER FUNCTIONS ---
    const openModal = (modal) => {
        modal.classList.add('active');
        document.body.classList.add('modal-open');
    };
    const closeModal = (modal) => {
        modal.classList.remove('active');
        document.body.classList.remove('modal-open');
    };
    
    function closeAllSelects(exceptThis) {
        document.querySelectorAll('.custom-select-wrapper').forEach(wrapper => {
            if (wrapper.querySelector('.select-selected') !== exceptThis) {
                wrapper.querySelector('.select-items').style.display = 'none';
                wrapper.closest('.product-card').classList.remove('product-card--focused');
            }
        });
    }
    
    function setupCustomSelects() {
        document.querySelectorAll('.custom-select-wrapper').forEach(wrapper => {
            const selected = wrapper.querySelector('.select-selected');
            const items = wrapper.querySelector('.select-items');
            const hiddenSelect = wrapper.querySelector('select');
            const card = wrapper.closest('.product-card');
            selected.addEventListener('click', e => {
                e.stopPropagation();
                const isAlreadyOpen = items.style.display === 'block';
                closeAllSelects(null);
                if (!isAlreadyOpen) {
                    items.style.display = 'block';
                    card.classList.add('product-card--focused');
                }
            });
            items.querySelectorAll('div').forEach(option => {
                option.addEventListener('click', function() {
                    selected.textContent = this.textContent;
                    hiddenSelect.value = this.textContent.replace('Size: ', '').trim();
                    closeAllSelects(null);
                });
            });
        });
    }
    
    // --- RENDERING LOGIC ---
    function renderProducts() {
        if (!productGrid) return;
        let filteredProducts = [];
        
        let productsToShow = [...allProductsCombined].reverse(); // Create a copy and reverse it
        
        if (currentGender === 'exclusive') {
            filteredProducts = productsToShow.filter(p => p.exclusive);
        } else {
            let genderFiltered = productsToShow.filter(p => p.gender === currentGender);
            
            if (currentSubcategory !== 'all') {
                filteredProducts = genderFiltered.filter(p => p.category.includes(currentSubcategory));
            } else {
                filteredProducts = genderFiltered;
            }
        }
        
        productGrid.innerHTML = filteredProducts.length > 0 ? filteredProducts.map(product => `
            <div class="product-card ${product.exclusive ? 'product-card--exclusive' : ''}">
                <img src="${product.imageUrl}" alt="${product.name}" class="product-image" loading="lazy">
                <div class="product-info">
                    <h3 class="product-name">${product.name}</h3>
                    <p class="product-price">‚Çπ${product.price} per item</p>
                    <p class="product-description">${product.description}</p>
                    <div class="custom-select-wrapper">
                        <select class="size-selector">${product.sizes.map(size => `<option value="${size}">${size}</option>`).join('')}</select>
                        <div class="select-selected">Size: ${product.sizes[0] || 'N/A'}</div>
                        <div class="select-items">${product.sizes.map(size => `<div>Size: ${size}</div>`).join('')}</div>
                    </div>
                    <button class="buy-now-btn" data-name="${product.name}" data-price="${product.price}">Buy Now</button>
                </div>
            </div>`).join('') : `<p style="text-align:center; grid-column: 1/-1;">No products found in this category.</p>`;
        
        setupCustomSelects();
    }
    
    function populateSubcategoryDropdown() {
        const subcategoryContainer = document.getElementById('subcategory-container');
        if (currentGender === 'exclusive') {
            subcategoryContainer.style.display = 'none';
            return;
        }
        
        subcategoryContainer.style.display = 'flex';
        subcategorySelect.innerHTML = '';
        const allOption = document.createElement('option');
        allOption.value = 'all';
        allOption.textContent = 'All Products';
        subcategorySelect.appendChild(allOption);
        
        const genderProducts = allProductsCombined.filter(p => p.gender === currentGender);
        const categories = [...new Set(genderProducts.flatMap(p => p.category))];
        
        categories.sort().forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            subcategorySelect.appendChild(option);
        });
        currentSubcategory = 'all';
        subcategorySelect.value = 'all';
    }
    
    // --- ADMIN PANEL ---
    function populateAdminPanel() {
        const tbody = document.getElementById('admin-links-tbody');
        tbody.innerHTML = [...allProductsCombined].reverse().map(product => `
            <tr>
                <td>
                    <img src="${product.imageUrl}" alt="${product.name}" class="admin-panel-product-img">
                    <span>${product.name}</span>
                </td>
                <td><a href="${product.sourceLink}" target="_blank">View Source</a></td>
            </tr>`).join('');
    }
    
    // --- EVENT LISTENERS ---
    function closeSideNav() {
        menuButton.classList.remove('active');
        mainNav.classList.remove('open');
        navBackdrop.classList.remove('visible');
        document.body.classList.remove('nav-open');
    }
    menuButton.addEventListener('click', () => {
        menuButton.classList.toggle('active');
        mainNav.classList.toggle('open');
        navBackdrop.classList.toggle('visible');
        document.body.classList.toggle('nav-open');
    });
    navBackdrop.addEventListener('click', closeSideNav);
    navAdminLink.addEventListener('click', (e) => {
        e.preventDefault();
        closeSideNav();
        setTimeout(() => openModal(adminLoginModal), 300);
    });
    const whatsappMessage = encodeURIComponent("Hello! I'm interested in your products.");
    navWhatsappLink.href = `https://wa.me/${ADMIN_PHONE_NUMBER}?text=${whatsappMessage}`;
    
    document.getElementById('admin-login-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const passwordInput = document.getElementById('admin-password');
        if (passwordInput.value === ADMIN_PASSWORD) {
            closeModal(adminLoginModal);
            populateAdminPanel();
            setTimeout(() => openModal(adminPanelModal), 300);
            passwordInput.value = '';
        }
    });
    
    document.querySelectorAll('.close-btn').forEach(btn => {
        btn.addEventListener('click', (e) => closeModal(e.target.closest('.modal-overlay')));
    });
    
    genderFilterContainer.addEventListener('click', (e) => {
        const clickedButton = e.target.closest('.gender-btn');
        if (!clickedButton || clickedButton.classList.contains('active')) return;
        currentGender = clickedButton.dataset.gender;
        genderFilterContainer.querySelector('.active').classList.remove('active');
        clickedButton.classList.add('active');
        populateSubcategoryDropdown();
        renderProducts();
    });
    
    subcategorySelect.addEventListener('change', () => {
        currentSubcategory = subcategorySelect.value;
        renderProducts();
    });
    
    productGrid.addEventListener('click', e => {
        if (e.target.classList.contains('buy-now-btn')) {
            const card = e.target.closest('.product-card');
            const name = e.target.dataset.name;
            const price = e.target.dataset.price;
            const size = card.querySelector('.size-selector').value;
            
            const product = allProductsCombined.find(p => p.name === name);
            if (!product) return;

            // Populate quantity dropdown based on minOrder
            const quantitySelect = document.getElementById('customer-quantity');
            quantitySelect.innerHTML = ''; // Clear previous options
            const minOrder = product.minOrder || 1;
            for (let i = minOrder; i <= 10; i++) { // Populate up to 10 items
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                quantitySelect.appendChild(option);
            }

            document.getElementById('form-product-name-display').textContent = name;
            document.getElementById('form-product-price-display').textContent = price;
            document.getElementById('form-product-size-display').textContent = size;
            openModal(orderModal);
        }
    });
    
    document.getElementById('order-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const productName = document.getElementById('form-product-name-display').textContent;
        const productPrice = document.getElementById('form-product-price-display').textContent;
        const productSize = document.getElementById('form-product-size-display').textContent;
        const customerName = document.getElementById('customer-name').value;
        const customerPhone = document.getElementById('customer-phone').value;
        const customerAddress = document.getElementById('customer-address').value;
        const quantity = document.getElementById('customer-quantity').value;
        
        const message = `*üõçÔ∏è New Order Request!*\n\n*Product:* ${productName}\n*Price:* ‚Çπ${productPrice} per item\n*Size:* ${productSize}\n*Quantity:* ${quantity}\n\n---\n\n*Customer Details:*\n*Name:* ${customerName}\n*Phone:* ${customerPhone}\n*Address:* ${customerAddress}`;
        const whatsappUrl = `https://wa.me/${ADMIN_PHONE_NUMBER}?text=${encodeURIComponent(message.trim())}`;
        
        window.open(whatsappUrl, '_blank');
        closeModal(orderModal);
        e.target.reset();
    });
    
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.custom-select-wrapper')) {
            closeAllSelects(null);
        }
    });
    
    // --- INITIALIZATION ---
    fetchProducts();
});

</script>

</body>
</html>
